<% if index == 0 %>
   <ul class="variant-option-values" class='inline'>
  <% values.sort_by(&:position).each do |value| %>
    <% classes = ["option-value"] %>
    <% unless (variants = @product.variants_for_option_value(value)).empty? %>
      <% classes << ( Spree::Config[:allow_backorders] || variants.sum(&:count_on_hand) > 0 || variants.map(&:on_demand).include?(true) ? "in-stock" : "out-of-stock" ) if index == 0 %>
      <% if !value.color.blank? %>
        <% classes << 'with-color' %>
        <li><%= link_to content_tag(:span, ""), "#", :title => value.presentation, :class => classes.join(" "), :rel => "#{type.id}-#{value.id}", :style => "background-color: #{value.color};" %></li>
      <% else %>
        <% classes << 'with-image' if value.has_image? %>
        <li><%= link_to value.has_image? ? image_tag(value.image.url, :alt => value.presentation) : content_tag(:span, value.presentation), "#", :title => value.presentation, :class => classes.join(" "), :rel => "#{type.id}-#{value.id}" %></li>
      <% end %>
    <% end %>
  <% end %>
    <li class="clear"></li>
  </ul>
<% else %>
  <ul class="variant-option-values" class='inline'>
  <% values.sort_by(&:position).each do |value| %>
    <% classes = ["option-value"] %>
    <% unless (variants = @product.variants_for_option_value(value)).empty? %>
      <% classes << ( Spree::Config[:allow_backorders] || variants.sum(&:count_on_hand) > 0 || variants.map(&:on_demand).include?(true) ? "in-stock" : "out-of-stock" ) if index == 0 %>
      <% classes << 'with-image' if value.has_image? %>
      <li><%= link_to value.has_image? ? image_tag(value.image.url, :alt => value.presentation) : content_tag(:span, value.presentation), "#", :title => value.presentation, :class => classes.join(" "), :rel => "#{type.id}-#{value.id}" %></li>
    <% end %>
  <% end %>
    <li class="clear"></li>
  </ul>
<% end %>